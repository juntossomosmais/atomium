import{d as A}from"./index-ZjP4CjeZ-C2-Wxc_X.js";import{d as N,k as D,c as q,e as V,g as j}from"./helpers-B-Uyga6H-B3beJCQV.js";import{OVERLAY_BACK_BUTTON_PRIORITY as G,shouldUseCloseWatcher as M}from"./hardware-back-button-D1ojTJxd-gG1MJ8AJ.js";import{n as L,m as h,q as U,y as W}from"./iframe-zABJLAdj.js";import{C as K}from"./framework-delegate-agWpu5N5-BFqr1oOj.js";import{B as R}from"./gesture-controller-BTEOs1at-iLJO98M1.js";const v='[tabindex]:not([tabindex^="-"]):not([hidden]):not([disabled]), input:not([type=hidden]):not([tabindex^="-"]):not([hidden]):not([disabled]), textarea:not([tabindex^="-"]):not([hidden]):not([disabled]), button:not([tabindex^="-"]):not([hidden]):not([disabled]), select:not([tabindex^="-"]):not([hidden]):not([disabled]), ion-checkbox:not([tabindex^="-"]):not([hidden]):not([disabled]), ion-radio:not([tabindex^="-"]):not([hidden]):not([disabled]), .ion-focusable:not([tabindex^="-"]):not([hidden]):not([disabled]), .ion-focusable[disabled="false"]:not([tabindex^="-"]):not([hidden])',C=(e,n)=>{const t=e.querySelector(v);T(t,n??e)},S=(e,n)=>{const t=Array.from(e.querySelectorAll(v)),o=t.length>0?t[t.length-1]:null;T(o,n??e)},T=(e,n)=>{let t=e;const o=e?.shadowRoot;if(o&&(t=o.querySelector(v)||e),t){const i=t.closest("ion-radio-group");i?i.setFocus():D(t)}else n.focus()};let b=0,Y=0;const g=new WeakMap,y=e=>{var n;return e.showBackdrop!==!1&&!(((n=e.backdropBreakpoint)!==null&&n!==void 0?n:0)>0)},w=e=>({create(n){return $(e,n)},dismiss(n,t,o){return J(document,n,t,e,o)},async getTop(){return p(document,e)}}),ue=w("ion-alert"),me=w("ion-action-sheet"),fe=w("ion-modal"),pe=w("ion-popover"),ve=e=>{typeof document<"u"&&Q(document);const n=b++;e.overlayIndex=n},ge=e=>(e.hasAttribute("id")||(e.id=`ion-overlay-${++Y}`),e.id),$=(e,n)=>typeof window<"u"&&typeof window.customElements<"u"?window.customElements.whenDefined(e).then(()=>{const t=document.createElement(e);return t.classList.add("overlay-hidden"),Object.assign(t,Object.assign(Object.assign({},n),{hasController:!0})),E(document).appendChild(t),new Promise(o=>q(t,o))}):Promise.resolve(),H=e=>e.classList.contains("overlay-hidden"),I=(e,n)=>{let t=e;const o=e?.shadowRoot;o&&(t=o.querySelector(v)||e),t?D(t):n.focus()},z=(e,n)=>{const t=p(n,"ion-alert,ion-action-sheet,ion-loading,ion-modal,ion-picker-legacy,ion-popover"),o=e.target;if(!t||!o||t.classList.contains(oe))return;const i=()=>{if(t===o)t.lastFocus=void 0;else if(o.tagName==="ION-TOAST")I(t.lastFocus,t);else{const a=j(t);if(!a.contains(o))return;const s=a.querySelector(".ion-overlay-wrapper");if(!s)return;if(s.contains(o)||o===a.querySelector("ion-backdrop"))t.lastFocus=o;else{const d=t.lastFocus;C(s,t),d===n.activeElement&&S(s,t),t.lastFocus=n.activeElement}}},r=()=>{if(t.contains(o))t.lastFocus=o;else if(o.tagName==="ION-TOAST")I(t.lastFocus,t);else{const a=t.lastFocus;C(t),a===n.activeElement&&S(t),t.lastFocus=n.activeElement}};t.shadowRoot?r():i()},Q=e=>{b===0&&(b=1,e.addEventListener("focus",n=>{z(n,e)},!0),e.addEventListener("ionBackButton",n=>{const t=p(e);t?.backdropDismiss&&n.detail.register(G,()=>{t.dismiss(void 0,O)})}),M()||e.addEventListener("keydown",n=>{if(n.key==="Escape"){const t=p(e);t?.backdropDismiss&&t.dismiss(void 0,O)}}))},J=(e,n,t,o,i)=>{const r=p(e,o,i);return r?r.dismiss(n,t):Promise.reject("overlay does not exist")},X=(e,n)=>(n===void 0&&(n="ion-alert,ion-action-sheet,ion-loading,ion-modal,ion-picker-legacy,ion-popover,ion-toast"),Array.from(e.querySelectorAll(n)).filter(t=>t.overlayIndex>0)),k=(e,n)=>X(e,n).filter(t=>!H(t)),p=(e,n,t)=>{const o=k(e,n);return(t===void 0?o:o.filter(i=>i.id===t)).slice(-1)[0]},F=(e=!1)=>{const t=E(document).querySelector("ion-router-outlet, #ion-view-container-root");t&&(e?t.setAttribute("aria-hidden","true"):t.removeAttribute("aria-hidden"))},he=async(e,n,t,o,i)=>{var r,a;if(e.presented)return;e.el.tagName!=="ION-TOAST"&&Z(e.el);const s=e.el,c=s.tagName!=="ION-TOAST"&&s.focusTrap!==!1&&y(s);if(e.presented=!0,e.willPresent.emit(),c){const l=E(document).querySelector("ion-router-outlet, #ion-view-container-root");(l?l.contains(s):!1)||F(!0),document.body.classList.add(R)}(r=e.willPresentShorthand)===null||r===void 0||r.emit();const u=L(e),m=e.enterAnimation?e.enterAnimation:h.get(n,u==="ios"?t:o);await x(e,m,e.el,i)&&(e.didPresent.emit(),(a=e.didPresentShorthand)===null||a===void 0||a.emit()),e.keyboardClose&&(document.activeElement===null||!e.el.contains(document.activeElement))&&e.el.focus(),e.el.removeAttribute("aria-hidden"),e.el.removeAttribute("inert")},Z=async e=>{let n=document.activeElement;if(!n)return;n.blur();const t=n?.shadowRoot;t&&(n=t.querySelector(v)||n),await e.onDidDismiss(),(document.activeElement===null||document.activeElement===document.body)&&n.focus()},we=async(e,n,t,o,i,r,a)=>{var s,d;if(!e.presented)return!1;const u=(A!==void 0?k(A):[]).filter(l=>{const f=l;return f.tagName!=="ION-TOAST"&&f.focusTrap!==!1&&y(f)}),m=e.el;m.tagName!=="ION-TOAST"&&m.focusTrap!==!1&&y(m)&&u.length===1&&u[0].id===m.id&&(F(!1),document.body.classList.remove(R)),e.presented=!1;try{e.el.style.setProperty("pointer-events","none"),e.willDismiss.emit({data:n,role:t}),(s=e.willDismissShorthand)===null||s===void 0||s.emit({data:n,role:t});const l=L(e),f=e.leaveAnimation?e.leaveAnimation:h.get(o,l==="ios"?i:r);t!==ne&&await x(e,f,e.el,a),e.didDismiss.emit({data:n,role:t}),(d=e.didDismissShorthand)===null||d===void 0||d.emit({data:n,role:t}),(g.get(e)||[]).forEach(_=>_.destroy()),g.delete(e),e.el.classList.add("overlay-hidden"),e.el.style.removeProperty("pointer-events"),e.el.lastFocus!==void 0&&(e.el.lastFocus=void 0)}catch(l){U(`[${e.el.tagName.toLowerCase()}] - `,l)}return e.el.remove(),!0},E=e=>e.querySelector("ion-app")||e.body,x=async(e,n,t,o)=>{t.classList.remove("overlay-hidden");const i=e.el,r=n(i,o);(!e.animated||!h.getBoolean("animated",!0))&&r.duration(0),e.keyboardClose&&r.beforeAddWrite(()=>{const s=t.ownerDocument.activeElement;s?.matches("input,ion-input, ion-textarea")&&s.blur()});const a=g.get(e)||[];return g.set(e,[...a,r]),await r.play(),!0},be=(e,n)=>{let t;const o=new Promise(i=>t=i);return ee(e,n,i=>{t(i.detail)}),o},ee=(e,n,t)=>{const o=i=>{V(e,n,o),t(i)};N(e,n,o)},ye=e=>e==="cancel"||e===O,te=e=>e(),Oe=(e,n)=>{if(typeof e=="function")return h.get("_zoneGate",te)(()=>{try{return e(n)}catch(o){throw o}})},O="backdrop",ne="gesture",Ee=39,Ae=e=>{let n=!1,t;const o=K(),i=(s=!1)=>{if(t&&!s)return{delegate:t,inline:n};const{el:d,hasController:c,delegate:u}=e;return n=d.parentNode!==null&&!c,t=n?u||o:u,{inline:n,delegate:t}};return{attachViewToDom:async s=>{const{delegate:d}=i(!0);if(d)return await d.attachViewToDom(e.el,s);const{hasController:c}=e;if(c&&s!==void 0)throw new Error("framework delegate is missing");return null},removeViewFromDom:()=>{const{delegate:s}=i();s&&e.el!==void 0&&s.removeViewFromDom(e.el.parentElement,e.el)}}},Ce=()=>{let e;const n=()=>{e&&(e(),e=void 0)};return{addClickListener:(o,i)=>{n();const r=i!==void 0?document.getElementById(i):null;if(!r){W(`[${o.tagName.toLowerCase()}] - A trigger element with the ID "${i}" was not found in the DOM. The trigger element must be in the DOM when the "trigger" property is set on an overlay component.`,o);return}e=((s,d)=>{const c=()=>{d.present()};return s.addEventListener("click",c),()=>{s.removeEventListener("click",c)}})(r,o)},removeClickListener:n}},oe="ion-disable-focus-trap";export{O as B,oe as F,ne as G,Ee as O,S as a,Ce as b,Ae as c,he as d,we as e,C as f,p as g,be as h,ye as i,Oe as j,pe as k,me as l,ue as m,fe as n,ve as p,ge as s};
