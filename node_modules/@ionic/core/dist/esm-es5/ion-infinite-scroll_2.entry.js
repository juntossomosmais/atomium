import{__awaiter,__generator}from"tslib";
/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */import{r as registerInstance,d as createEvent,w as writeTask,e as readTask,h,f as getElement,H as Host}from"./index-be218d70.js";import{b as getIonMode,c as config}from"./ionic-global-3b28a225.js";import{f as findClosestIonContent,p as printIonContentErrorMsg,g as getScrollElement}from"./index-d60493fd.js";import{E as ENABLE_HTML_CONTENT_DEFAULT,a as sanitizeDOMString}from"./config-80c044f2.js";import"./helpers-5eb6364d.js";import"./index-e86f0117.js";var infiniteScrollCss="ion-infinite-scroll{display:none;width:100%}.infinite-scroll-enabled{display:block}";var InfiniteScroll=function(){function i(i){var n=this;registerInstance(this,i);this.ionInfinite=createEvent(this,"ionInfinite",7);this.thrPx=0;this.thrPc=0;this.didFire=false;this.isBusy=false;this.onScroll=function(){var i=n.scrollEl;if(!i||!n.canStart()){return 1}var e=n.el.offsetHeight;if(e===0){return 2}var t=i.scrollTop;var o=i.scrollHeight;var r=i.offsetHeight;var s=n.thrPc!==0?r*n.thrPc:n.thrPx;var l=n.position==="bottom"?o-e-t-s-r:t-e-s;if(l<0){if(!n.didFire){n.isLoading=true;n.didFire=true;n.ionInfinite.emit();return 3}}else{n.didFire=false}return 4};this.isLoading=false;this.threshold="15%";this.disabled=false;this.position="bottom"}i.prototype.thresholdChanged=function(){var i=this.threshold;if(i.lastIndexOf("%")>-1){this.thrPx=0;this.thrPc=parseFloat(i)/100}else{this.thrPx=parseFloat(i);this.thrPc=0}};i.prototype.disabledChanged=function(){var i=this.disabled;if(i){this.isLoading=false;this.isBusy=false}this.enableScrollEvents(!i)};i.prototype.connectedCallback=function(){return __awaiter(this,void 0,void 0,(function(){var i,n;var e=this;return __generator(this,(function(t){switch(t.label){case 0:i=findClosestIonContent(this.el);if(!i){printIonContentErrorMsg(this.el);return[2]}n=this;return[4,getScrollElement(i)];case 1:n.scrollEl=t.sent();this.thresholdChanged();this.disabledChanged();if(this.position==="top"){writeTask((function(){if(e.scrollEl){e.scrollEl.scrollTop=e.scrollEl.scrollHeight-e.scrollEl.clientHeight}}))}return[2]}}))}))};i.prototype.disconnectedCallback=function(){this.enableScrollEvents(false);this.scrollEl=undefined};i.prototype.complete=function(){return __awaiter(this,void 0,void 0,(function(){var i,n;var e=this;return __generator(this,(function(t){i=this.scrollEl;if(!this.isLoading||!i){return[2]}this.isLoading=false;if(this.position==="top"){this.isBusy=true;n=i.scrollHeight-i.scrollTop;requestAnimationFrame((function(){readTask((function(){var t=i.scrollHeight;var o=t-n;requestAnimationFrame((function(){writeTask((function(){i.scrollTop=o;e.isBusy=false}))}))}))}))}return[2]}))}))};i.prototype.canStart=function(){return!this.disabled&&!this.isBusy&&!!this.scrollEl&&!this.isLoading};i.prototype.enableScrollEvents=function(i){if(this.scrollEl){if(i){this.scrollEl.addEventListener("scroll",this.onScroll)}else{this.scrollEl.removeEventListener("scroll",this.onScroll)}}};i.prototype.render=function(){var i;var n=getIonMode(this);var e=this.disabled;return h(Host,{class:(i={},i[n]=true,i["infinite-scroll-loading"]=this.isLoading,i["infinite-scroll-enabled"]=!e,i)})};Object.defineProperty(i.prototype,"el",{get:function(){return getElement(this)},enumerable:false,configurable:true});Object.defineProperty(i,"watchers",{get:function(){return{threshold:["thresholdChanged"],disabled:["disabledChanged"]}},enumerable:false,configurable:true});return i}();InfiniteScroll.style=infiniteScrollCss;var infiniteScrollContentIosCss="ion-infinite-scroll-content{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;-ms-flex-pack:center;justify-content:center;min-height:84px;text-align:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.infinite-loading{margin-left:0;margin-right:0;margin-top:0;margin-bottom:32px;display:none;width:100%}.infinite-loading-text{-webkit-margin-start:32px;margin-inline-start:32px;-webkit-margin-end:32px;margin-inline-end:32px;margin-top:4px;margin-bottom:0}.infinite-scroll-loading ion-infinite-scroll-content>.infinite-loading{display:block}.infinite-scroll-content-ios .infinite-loading-text{color:var(--ion-color-step-600, #666666)}.infinite-scroll-content-ios .infinite-loading-spinner .spinner-lines-ios line,.infinite-scroll-content-ios .infinite-loading-spinner .spinner-lines-small-ios line,.infinite-scroll-content-ios .infinite-loading-spinner .spinner-crescent circle{stroke:var(--ion-color-step-600, #666666)}.infinite-scroll-content-ios .infinite-loading-spinner .spinner-bubbles circle,.infinite-scroll-content-ios .infinite-loading-spinner .spinner-circles circle,.infinite-scroll-content-ios .infinite-loading-spinner .spinner-dots circle{fill:var(--ion-color-step-600, #666666)}";var infiniteScrollContentMdCss="ion-infinite-scroll-content{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;-ms-flex-pack:center;justify-content:center;min-height:84px;text-align:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.infinite-loading{margin-left:0;margin-right:0;margin-top:0;margin-bottom:32px;display:none;width:100%}.infinite-loading-text{-webkit-margin-start:32px;margin-inline-start:32px;-webkit-margin-end:32px;margin-inline-end:32px;margin-top:4px;margin-bottom:0}.infinite-scroll-loading ion-infinite-scroll-content>.infinite-loading{display:block}.infinite-scroll-content-md .infinite-loading-text{color:var(--ion-color-step-600, #666666)}.infinite-scroll-content-md .infinite-loading-spinner .spinner-lines-md line,.infinite-scroll-content-md .infinite-loading-spinner .spinner-lines-small-md line,.infinite-scroll-content-md .infinite-loading-spinner .spinner-crescent circle{stroke:var(--ion-color-step-600, #666666)}.infinite-scroll-content-md .infinite-loading-spinner .spinner-bubbles circle,.infinite-scroll-content-md .infinite-loading-spinner .spinner-circles circle,.infinite-scroll-content-md .infinite-loading-spinner .spinner-dots circle{fill:var(--ion-color-step-600, #666666)}";var InfiniteScrollContent=function(){function i(i){registerInstance(this,i);this.customHTMLEnabled=config.get("innerHTMLTemplatesEnabled",ENABLE_HTML_CONTENT_DEFAULT);this.loadingSpinner=undefined;this.loadingText=undefined}i.prototype.componentDidLoad=function(){if(this.loadingSpinner===undefined){var i=getIonMode(this);this.loadingSpinner=config.get("infiniteLoadingSpinner",config.get("spinner",i==="ios"?"lines":"crescent"))}};i.prototype.renderLoadingText=function(){var i=this,n=i.customHTMLEnabled,e=i.loadingText;if(n){return h("div",{class:"infinite-loading-text",innerHTML:sanitizeDOMString(e)})}return h("div",{class:"infinite-loading-text"},this.loadingText)};i.prototype.render=function(){var i;var n=getIonMode(this);return h(Host,{class:(i={},i[n]=true,i["infinite-scroll-content-".concat(n)]=true,i)},h("div",{class:"infinite-loading"},this.loadingSpinner&&h("div",{class:"infinite-loading-spinner"},h("ion-spinner",{name:this.loadingSpinner})),this.loadingText!==undefined&&this.renderLoadingText()))};return i}();InfiniteScrollContent.style={ios:infiniteScrollContentIosCss,md:infiniteScrollContentMdCss};export{InfiniteScroll as ion_infinite_scroll,InfiniteScrollContent as ion_infinite_scroll_content};