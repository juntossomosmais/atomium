var __create=Object.create;var __defProp=Object.defineProperty;var __getOwnPropDesc=Object.getOwnPropertyDescriptor;var __getOwnPropNames=Object.getOwnPropertyNames;var __getProtoOf=Object.getPrototypeOf,__hasOwnProp=Object.prototype.hasOwnProperty;var __export=(target,all)=>{for(var name in all)__defProp(target,name,{get:all[name],enumerable:!0})},__copyProps=(to,from,except,desc)=>{if(from&&typeof from=="object"||typeof from=="function")for(let key of __getOwnPropNames(from))!__hasOwnProp.call(to,key)&&key!==except&&__defProp(to,key,{get:()=>from[key],enumerable:!(desc=__getOwnPropDesc(from,key))||desc.enumerable});return to};var __toESM=(mod,isNodeMode,target)=>(target=mod!=null?__create(__getProtoOf(mod)):{},__copyProps(isNodeMode||!mod||!mod.__esModule?__defProp(target,"default",{value:mod,enumerable:!0}):target,mod)),__toCommonJS=mod=>__copyProps(__defProp({},"__esModule",{value:!0}),mod);var common_preset_exports={};__export(common_preset_exports,{babel:()=>babel,core:()=>core,docs:()=>docs,env:()=>env,favicon:()=>favicon2,features:()=>features,frameworkOptions:()=>frameworkOptions,logLevel:()=>logLevel,previewAnnotations:()=>previewAnnotations,previewBody:()=>previewBody,previewHead:()=>previewHead,staticDirs:()=>staticDirs,storyIndexers:()=>storyIndexers,title:()=>title,typescript:()=>typescript});module.exports=__toCommonJS(common_preset_exports);var import_fs_extra2=require("fs-extra"),import_node_logger2=require("@storybook/node-logger"),import_core_common2=require("@storybook/core-common"),import_csf_tools=require("@storybook/csf-tools"),import_path3=require("path"),import_ts_dedent2=require("ts-dedent");var import_node_logger=require("@storybook/node-logger"),import_core_common=require("@storybook/core-common"),import_chalk=__toESM(require("chalk")),import_express=__toESM(require("express")),import_fs_extra=require("fs-extra"),import_path2=__toESM(require("path")),import_serve_favicon=__toESM(require("serve-favicon")),import_isEqual=__toESM(require("lodash/isEqual.js")),import_ts_dedent=require("ts-dedent");var import_path=require("path");var defaultStaticDirs=[{from:(0,import_path.join)((0,import_path.dirname)(require.resolve("@storybook/manager/package.json")),"static"),to:"/sb-common-assets"}];var parseStaticDir=async arg=>{let lastColonIndex=arg.lastIndexOf(":"),isWindowsRawDirOnly=import_path2.default.win32.isAbsolute(arg)&&lastColonIndex===1,splitIndex=lastColonIndex!==-1&&!isWindowsRawDirOnly?lastColonIndex:arg.length,target=(arg.substring(splitIndex+1)||"/").split(import_path2.default.sep).join(import_path2.default.posix.sep),rawDir=arg.substring(0,splitIndex),staticDir=import_path2.default.isAbsolute(rawDir)?rawDir:`./${rawDir}`,staticPath=import_path2.default.resolve(staticDir),targetDir=target.replace(/^\/?/,"./"),targetEndpoint=targetDir.substring(1);if(!await(0,import_fs_extra.pathExists)(staticPath))throw new Error((0,import_ts_dedent.dedent)(import_chalk.default`
        Failed to load static files, no such directory: {cyan ${staticPath}}
        Make sure this directory exists, or omit the {bold -s (--static-dir)} option.
      `));return{staticDir,staticPath,targetDir,targetEndpoint}};var defaultFavicon=require.resolve("@storybook/core-server/public/favicon.svg"),staticDirs=async(values=[])=>[...defaultStaticDirs,...values],favicon2=async(value,options)=>{if(value)return value;let staticDirsValue=await options.presets.apply("staticDirs"),statics=staticDirsValue?staticDirsValue.map(dir=>typeof dir=="string"?dir:`${dir.from}:${dir.to}`):options.staticDir;if(statics&&statics.length>0){let flatlist=(await Promise.all(statics.map(async dir=>{let results=[],relativeDir=staticDirsValue?(0,import_core_common2.getDirectoryFromWorkingDir)({configDir:options.configDir,workingDir:process.cwd(),directory:dir}):dir,{staticPath,targetEndpoint}=await parseStaticDir(relativeDir);if(targetEndpoint==="/"){let path2=(0,import_path3.join)(staticPath,"favicon.svg");await(0,import_fs_extra2.pathExists)(path2)&&results.push(path2)}if(targetEndpoint==="/"){let path2=(0,import_path3.join)(staticPath,"favicon.ico");await(0,import_fs_extra2.pathExists)(path2)&&results.push(path2)}return results}))).reduce((l1,l2)=>l1.concat(l2),[]);return flatlist.length>1&&import_node_logger2.logger.warn(import_ts_dedent2.dedent`
        Looks like multiple favicons were detected. Using the first one.
        
        ${flatlist.join(", ")}
        `),flatlist[0]||defaultFavicon}return defaultFavicon},babel=async(_,options)=>{let{presets}=options;return presets.apply("babelDefault",{},options)},title=(previous,options)=>previous||options.packageJson.name||!1,logLevel=(previous,options)=>previous||options.loglevel||"info",previewHead=async(base,{configDir,presets})=>{let interpolations=await presets.apply("env");return(0,import_core_common2.getPreviewHeadTemplate)(configDir,interpolations)},env=async()=>(0,import_core_common2.loadEnvs)({production:!0}).raw,previewBody=async(base,{configDir,presets})=>{let interpolations=await presets.apply("env");return(0,import_core_common2.getPreviewBodyTemplate)(configDir,interpolations)},typescript=()=>({check:!1,reactDocgen:"react-docgen-typescript",reactDocgenTypescriptOptions:{shouldExtractLiteralValuesFromEnum:!0,shouldRemoveUndefinedFromOptional:!0,propFilter:prop=>prop.parent?!/node_modules/.test(prop.parent.fileName):!0,savePropValueAsString:!0}}),optionalEnvToBoolean=input=>{if(input!==void 0){if(input.toUpperCase()==="FALSE")return!1;if(input.toUpperCase()==="TRUE"||typeof input=="string")return!0}},core=async(existing,options)=>({...existing,disableTelemetry:options.disableTelemetry===!0,enableCrashReports:options.enableCrashReports||optionalEnvToBoolean(process.env.STORYBOOK_ENABLE_CRASH_REPORTS)}),previewAnnotations=async(base,options)=>{let config=await options.presets.apply("config",[],options);return config.length>0&&(0,import_node_logger2.deprecate)("You (or an addon) are using the 'config' preset field. This has been replaced by 'previewAnnotations' and will be removed in 8.0"),[...config,...base]},features=async existing=>({...existing,warnOnLegacyHierarchySeparator:!0,buildStoriesJson:!1,storyStoreV7:!0,argTypeTargetsV7:!0,legacyDecoratorFileOrder:!1}),storyIndexers=async indexers=>[{test:/(stories|story)\.[tj]sx?$/,indexer:async(fileName,opts)=>{let code=(await(0,import_fs_extra2.readFile)(fileName,"utf-8")).toString();return(0,import_csf_tools.loadCsf)(code,{...opts,fileName}).parse()}},...indexers||[]],frameworkOptions=async(_,options)=>{let config=await options.presets.apply("framework");return typeof config=="string"?{}:typeof config>"u"?null:config.options},docs=(docsOptions,{docs:docsMode})=>({...docsOptions,docsMode});0&&(module.exports={babel,core,docs,env,favicon,features,frameworkOptions,logLevel,previewAnnotations,previewBody,previewHead,staticDirs,storyIndexers,title,typescript});
